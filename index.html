<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Animated Face Marker on Google Maps</title>
  <style>
    /* Full-screen map */
    #map { height: 100vh; width: 100%; }

    /* Leaderboard panel */
    #leaderboard {
      position: absolute; top: 10px; right: 10px;
      background: #fff; padding: 16px; border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.3);
      z-index: 1002; font-family: Arial, sans-serif;
      font-size: 16px; max-height: 90vh; overflow-y: auto;
      line-height: 1.6; min-width: 240px;
    }
    #leaderboard img {
      vertical-align: middle;
      width: 1em; height: 1em;
      border-radius: 50%;
      margin-right: 4px;
    }
  </style>
</head>
<body>
  <div id="leaderboard">
    <strong>Leaderboard</strong>
    <ul id="leaderboard-list"></ul>
  </div>
  <div id="map"></div>

  <!-- Load Maps API once, with both geometry + marker libraries -->
  <script
    defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA23ORAayerNpeDh8WhQkwsv0ZNAon41FI&callback=initMap&libraries=geometry,marker">
  </script>

  <script>
    // === CONFIG ===
    const HQ = { lat: 50.43135, lng: -3.797092 };
    const HQ_ICON   = 'img/JHB Logo.png';
    const GOLDEN_CIRCLE = 'img/A_2D_digital_illustration_features_a_circular_gold.png';
    const WAYPOINTS = [
      'London, UK','Paris, France','Brussels, Belgium','Amsterdam, Netherlands',
      'Berlin, Germany','Prague, Czech Republic','Vienna, Austria','Bratislava, Slovakia',
      'Budapest, Hungary'
    ];
    const DESTINATION = 'Zagreb, Croatia';
    const PEOPLE = [
      'Adrian Lutic','Alex Nita','Antun Vidakovic','Bradley Tunstill','Brendon Kilcullen',
      'Byron Claridge','Callum Evans','Cameron Gill','Christopher Scourfield','Craig Dolan',
      'Darren Hatfield','David Mahon','Edward Shanley','Gary Mounce','George Norris',
      'James Hickman','James Hodge-Brooks','James Rundle-Jones','Jay Dunn',
      'Joe Lambourne-Gillen','John Peters','Jonathan Thompson','Joseph Nixon',
      'Joseph Young','Joshua Powell','Joshua Rowberry','Lewis Cannon','Liam Hammon',
      'Luke Piller','Mark Sneap','Morgan Hemming','Nicholas Kingshott','Richard Clanford',
      'Richard Turvey','Robert Tamas','Ross Watson','Ryan Breslan','Ryan Manners',
      'Tom Brooks','Tyler Webb'
    ];
    const MAX_DISTANCE = 200000;  // meters
    const ICON_SIZE = 64;         // px

    // === MAIN ENTRY POINT ===
    function initMap() {
      const ds = new google.maps.DirectionsService();
      ds.route({
        origin: HQ,
        destination: DESTINATION,
        waypoints: WAYPOINTS.map(loc => ({ location: loc })),
        travelMode: 'DRIVING'
      }, (res, status) => {
        if (status !== 'OK') {
          console.error('DirectionsService error:', status);
          return;
        }
        drawAnimatedMap(res.routes[0].overview_path);
      });
    }

    function drawAnimatedMap(path) {
      // Create the map and bounds
      const map = new google.maps.Map(document.getElementById('map'));
      const bounds = new google.maps.LatLngBounds();
      bounds.extend(HQ);

      // Precompute cumulative distances
      const segments = [];
      for (let i = 0; i < path.length - 1; i++) {
        segments.push(
          google.maps.geometry.spherical.computeDistanceBetween(path[i], path[i+1])
        );
      }
      const cumDist = segments.reduce((arr, d) => {
        arr.push(arr[arr.length-1] + d);
        return arr;
      }, [0]);

      // HQ marker
      new google.maps.Marker({
        map,
        position: HQ,
        icon: {
          url: HQ_ICON,
          scaledSize: new google.maps.Size(ICON_SIZE, ICON_SIZE),
          anchor: new google.maps.Point(ICON_SIZE/2, ICON_SIZE/2)
        },
        title: 'JHB UK Ltd',
        zIndex: 999
      });

      // Build p
