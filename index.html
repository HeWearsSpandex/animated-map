<!DOCTYPE html>
<html>
<head>
  <title>Animated Face Marker on Google Maps</title>
  <style>
    #map {
      height: 100vh;
      width: 100%;
    }
    .animated-marker img {
      width: 40px;
      height: 40px;
      animation: bounce 1s infinite;
    }
    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }
  </style>
</head>
<body>
  <div id="map"></div>

  <script>
    class AnimatedMarker extends google.maps.OverlayView {
      constructor(position) {
        super();
        this.position = position;
        this.div = null;
      }

      onAdd() {
        this.div = document.createElement("div");
        this.div.className = "animated-marker";
        this.div.style.position = "absolute";
        this.div.style.width = "40px";
        this.div.style.height = "40px";
        this.div.style.zIndex = "1000";
        this.div.innerHTML = `<img src="https://i.imgur.com/8Km9tLL.png" alt="Face Marker">`;
        const panes = this.getPanes();
        panes.overlayMouseTarget.appendChild(this.div);
      }

      draw() {
        const projection = this.getProjection();
        if (!projection || !this.div) return;
        const point = projection.fromLatLngToDivPixel(this.position);
        if (point) {
          this.div.style.left = `${point.x - 20}px`;
          this.div.style.top = `${point.y - 20}px`;
        }
      }

      onRemove() {
        if (this.div) this.div.remove();
      }
    }

    function initMap() {
      const centerPosition = new google.maps.LatLng(50.427, -3.833);
      const map = new google.maps.Map(document.getElementById("map"), {
        zoom: 10,
        center: centerPosition,
      });

      const animatedMarker = new AnimatedMarker(centerPosition);
      animatedMarker.setMap(map);

      const staticMarkers = [
        { lat: 50.429, lng: -3.830, name: "Alex" },
        { lat: 50.425, lng: -3.836, name: "Cameron" },
        { lat: 50.430, lng: -3.840, name: "Lewis" },
        { lat: 50.422, lng: -3.829, name: "James" },
        { lat: 50.426, lng: -3.820, name: "Sophie" },
        { lat: 50.428, lng: -3.845, name: "Daniel" },
        { lat: 50.421, lng: -3.832, name: "Chloe" },
        { lat: 50.432, lng: -3.838, name: "Ryan" },
        { lat: 50.424, lng: -3.842, name: "Megan" }
      ];

      staticMarkers.forEach(pos => {
        const marker = new AnimatedMarker(new google.maps.LatLng(pos.lat, pos.lng));
        marker.setMap(map);

        const label = new google.maps.InfoWindow({
          content: `<strong>${pos.name}</strong>`
        });

        const interval = setInterval(() => {
          if (marker.div) {
            marker.div.addEventListener("click", () => {
              label.setPosition(new google.maps.LatLng(pos.lat, pos.lng));
              label.open(map);
            });
            clearInterval(interval);
          }
        }, 200);
      });
    }
  </script>

  <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA23ORAayerNpeDh8WhQkwsv0ZNAon41FI&callback=initMap">
  </script>
</body>
</html>
